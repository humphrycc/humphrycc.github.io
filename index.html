<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>HUCHI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="HUCHI">
<meta property="og:url" content="https://humphrycc.github.io/index.html">
<meta property="og:site_name" content="HUCHI">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="HUCHI" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">HUCHI</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://humphrycc.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Do-we-need-User-defined-literal" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/27/Do-we-need-User-defined-literal/" class="article-date">
  <time class="dt-published" datetime="2021-04-27T13:22:52.000Z" itemprop="datePublished">2021-04-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/27/Do-we-need-User-defined-literal/">Do we need User-defined literal?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/238057/6799372">https://stackoverflow.com/a/238057/6799372</a></p>
</blockquote>
<p>At first sight, it seems to be simple syntactic sugar.</p>
<p>But when looking deeper, we see it’s more than syntactic sugar, as <strong>it extends the C++ user’s options to create user-defined types that behave exactly like distinct built-in types</strong>. In this, this little “bonus” is a very interesting C++11 addition to C++.</p>
<h1 id="Do-we-really-need-it-in-C"><a href="#Do-we-really-need-it-in-C" class="headerlink" title="Do we really need it in C++?"></a>Do we really need it in C++?</h1><p>I see few uses in the code I wrote in the past years, but just because I didn’t use it in C++ doesn’t mean it’s not interesting for <em>another C++ developer</em>.</p>
<p>We had used in C++ (and in C, I guess), compiler-defined literals, to type integer numbers as <code>short</code> or <code>long</code> integers, real numbers as <code>float</code> or <code>double</code> (or even <code>long double</code>), and character strings as normal or wide chars.</p>
<p><strong>In C++, we had the possibility to create our own types (i.e. classes), with potentially no overhead (inlining, etc.).</strong> We had the possibility to add operators to their types, to have them behave like similar built-in types, which enables C++ developers to use matrices and complex numbers as naturally as they would have if these have been added to the language itself. We can even add cast operators (which is usually a bad idea, but sometimes, it’s just the right solution).</p>
<p><strong>We still missed one thing to have user-types behave as built-in types: user-defined literals.</strong></p>
<p>So, I guess it’s a natural evolution for the language, but to be as complete as possible: “<em>If you want to create a type, and you want it to behave as much possible as a built-in types, here are the tools…</em>“</p>
<p>I’d guess it’s very similar to .NET’s decision to make every primitive a struct, including booleans, integers, etc., and have all structs derive from Object. This decision alone puts .NET far beyond Java’s reach when working with primitives, no matter how much boxing/unboxing hacks Java will add to its specification.</p>
<h1 id="Do-YOU-really-need-it-in-C"><a href="#Do-YOU-really-need-it-in-C" class="headerlink" title="Do YOU really need it in C++?"></a>Do YOU really need it in C++?</h1><p>This question is for <strong>YOU</strong> to answer. Not Bjarne Stroustrup. Not Herb Sutter. Not whatever member of C++ standard committee. This is why you have the choice in C++, and they won’t restrict a useful notation to built-in types alone.</p>
<p>If you need it, then it is a welcome addition. If you don’t, well… Don’t use it. It will cost you nothing.</p>
<p>Welcome to C++, the language where features are optional.</p>
<h2 id="Bloated-Show-me-your-complexes"><a href="#Bloated-Show-me-your-complexes" class="headerlink" title="Bloated??? Show me your complexes!!!"></a>Bloated??? Show me your complexes!!!</h2><p>There is a difference between bloated and complex (pun intended).</p>
<p>Like shown by Niels at <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/237804/what-new-capabilities-do-user-defined-literals-add-to-c#237821">What new capabilities do user-defined literals add to C++?</a>, being able to write a complex number is one of the two features added “recently” to C and C++:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C89:</span></span><br><span class="line">MyComplex z1 = &#123; <span class="number">1</span>, <span class="number">2</span> &#125; ;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C99: You&#x27;ll note I is a macro, which can lead</span></span><br><span class="line"><span class="comment">// to very interesting situations...</span></span><br><span class="line"><span class="keyword">double</span> complex z1 = <span class="number">1</span> + <span class="number">2</span>*I;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C++:</span></span><br><span class="line"><span class="function">std::complex&lt;<span class="keyword">double</span>&gt; <span class="title">z1</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>)</span> </span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C++11: You&#x27;ll note that &quot;i&quot; won&#x27;t ever bother</span></span><br><span class="line"><span class="comment">// you elsewhere</span></span><br><span class="line">std::complex&lt;<span class="keyword">double</span>&gt; z1 = <span class="number">1</span> + <span class="number">2</span>_i ;</span><br></pre></td></tr></table></figure>

<p>Now, both C99 <code>double complex</code> type and C++ <code>std::complex</code> type are able to be multiplied, added, subtracted, etc., using operator overloading.</p>
<p>But in C99, they just added another type as a built-in type, and built-in operator overloading support. And they added another built-in literal feature.</p>
<p>In C++, they just used existing features of the language, saw that the literal feature was a natural evolution of the language, and thus added it.</p>
<p>In C, if you need the same notation enhancement for another type, you’re out of luck until your lobbying to add your quantum wave functions (or 3D points, or whatever basic type you’re using in your field of work) to the C standard as a built-in type succeeds.</p>
<p>In C++11, you just can do it yourself:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Point p = <span class="number">25</span>_x + <span class="number">13</span>_y + <span class="number">3</span>_z ; <span class="comment">// 3D point</span></span><br></pre></td></tr></table></figure>

<p><strong>Is it bloated? No</strong>, the need is there, as shown by how both C and C++ complexes need a way to represent their literal complex values.</p>
<p><strong>Is it wrongly designed? No</strong>, it’s designed as every other C++ feature, with extensibility in mind.</p>
<p><strong>Is it for notation purposes only? No</strong>, as it can even add type safety to your code.</p>
<p>For example, let’s imagine a CSS oriented code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">css::Font::Size p0 = <span class="number">12</span>_pt ;       <span class="comment">// Ok</span></span><br><span class="line">css::Font::Size p1 = <span class="number">50</span>_percent ;  <span class="comment">// Ok</span></span><br><span class="line">css::Font::Size p2 = <span class="number">15</span>_px ;       <span class="comment">// Ok</span></span><br><span class="line">css::Font::Size p3 = <span class="number">10</span>_em ;       <span class="comment">// Ok</span></span><br><span class="line">css::Font::Size p4 = <span class="number">15</span> ;          <span class="comment">// ERROR : Won&#x27;t compile !</span></span><br></pre></td></tr></table></figure>

<p>It is then very easy to enforce a strong typing to the assignment of values.</p>
<h2 id="Is-is-dangerous"><a href="#Is-is-dangerous" class="headerlink" title="Is is dangerous?"></a>Is is dangerous?</h2><p>Good question. Can these functions be namespaced? If yes, then Jackpot!</p>
<p>Anyway, <strong>like everything, you can kill yourself if a tool is used improperly</strong>. C is powerful, and you can shoot your head off if you misuse the C gun. C++ has the C gun, but also the scalpel, the taser, and whatever other tool you’ll find in the toolkit. You can misuse the scalpel and bleed yourself to death. Or you can build very elegant and robust code.</p>
<p>So, like every C++ feature, do you really need it? It is the question you must answer before using it in C++. If you don’t, it will cost you nothing. But if you do really need it, at least, the language won’t let you down.</p>
<h2 id="The-date-example"><a href="#The-date-example" class="headerlink" title="The date example?"></a>The date example?</h2><p>Your error, it seems to me, is that you are mixing operators:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1974</span>/<span class="number">01</span>/<span class="number">06</span>AD</span><br><span class="line">    ^  ^  ^</span><br></pre></td></tr></table></figure>

<p>This can’t be avoided, because <code>/</code> being an operator, the compiler must interpret it. And, AFAIK, it is a good thing.</p>
<p>To find a solution for your problem, I would write the literal in some other way. For example:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;1974-01-06&quot;</span>_AD ;   <span class="comment">// ISO-like notation</span></span><br><span class="line"><span class="string">&quot;06/01/1974&quot;</span>_AD ;   <span class="comment">// french-date-like notation</span></span><br><span class="line"><span class="string">&quot;jan 06 1974&quot;</span>_AD ;  <span class="comment">// US-date-like notation</span></span><br><span class="line"><span class="number">19740106</span>_AD ;       <span class="comment">// integer-date-like notation</span></span><br></pre></td></tr></table></figure>

<p>Personally, I would choose the integer and the ISO dates, but it depends on YOUR needs. Which is the whole point of letting the user define its own literal names.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/27/Do-we-need-User-defined-literal/" data-id="cknzlw0l00001gsose3cz9ir2" data-title="Do we need User-defined literal?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Virtuality" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/Virtuality/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T14:52:11.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/Virtuality/">Virtuality</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="http://www.gotw.ca/publications/mill18.htm">http://www.gotw.ca/publications/mill18.htm</a></p>
</blockquote>
<blockquote>
<p><em>This article appeared in <strong>C/C++ Users Journal, 19(9), September 2001</strong>.</em></p>
</blockquote>
<p>This month, I want to present up-to-date answers to two recurring questions about <code>virtual</code> functions. These answers then lead directly to four class design guidelines.</p>
<p>The questions are old, but people still keep asking them, and some of the answers have changed over time as we’ve gained experience with modern C++.</p>
<h1 id="Virtual-Question-1-Publicity-vs-Privacy"><a href="#Virtual-Question-1-Publicity-vs-Privacy" class="headerlink" title="Virtual Question #1: Publicity vs. Privacy?"></a>Virtual Question #1: Publicity vs. Privacy?</h1><p>The first of the two classic questions we’ll consider is this: <strong>“When should virtual functions be <code>public</code>, protected, or <code>private</code>?”</strong> The short answer is: <em>Rarely if ever, sometimes, and by default, respectively - the same answer we’ve already learned for other kinds of class members.</em></p>
<p>Most of us have learned through bitter experience to make all class members <code>private</code> by default unless we really need to expose them. That’s just good encapsulation. Certainly we’ve long ago learned that data members should always be <code>private</code> (except only in the case of C-style data structs, which are merely convenient groupings of data and are not intended to encapsulate anything). The same also goes for member functions, and so I propose the following guidelines which could be summarized as a statement about the benefits of privatization.</p>
<h2 id="Guideline-1-Prefer-to-make-interfaces-nonvirtual-using-Template-Method"><a href="#Guideline-1-Prefer-to-make-interfaces-nonvirtual-using-Template-Method" class="headerlink" title="Guideline #1: Prefer to make interfaces nonvirtual, using Template Method."></a>Guideline #1: Prefer to make interfaces nonvirtual, using Template Method.</h2><p>Interestingly, the C++ standard library already overwhelmingly follows this guideline. Not counting destructors (which are discussed separately later on under Guideline #4), and not double-counting the same <code>virtual</code> function twice when it appears again in a specialization of a class template, here’s what the standard library has:</p>
<ul>
<li>6 public <code>virtual</code> functions, all of which are <code>std::exception::what()</code> and its overrides</li>
<li>142 nonpublic <code>virtual</code> functions</li>
</ul>
<p>Why is this such a good idea? Let’s investigate.</p>
<p>Traditionally, many programmers were used to writing base classes using <code>public</code> <code>virtual</code> functions to directly and simultaneously specify both the interface and the customizable behavior. For example, we might write:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 1: A traditional base class.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Each of these functions might optionally be</span></span><br><span class="line">    <span class="comment">// pure virtual, and if so might or might not have</span></span><br><span class="line">    <span class="comment">// an implementation in Widget; see Item 27 in [1].</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">Process</span><span class="params">( Gadget&amp; )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">IsDone</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>The problem is that “simultaneously” part, because each <code>virtual</code> function is doing two jobs: It’s <em>specifying interface</em> because it’s <code>public</code> and therefore directly part of the interface <code>Widget</code> presents to the rest of the world; and it’s <em>specifying implementation detail</em>, namely the internally customizable behavior, because it’s <code>virtual</code> and therefore provides a hook for derived classes to replace the base implementation of that function (if any). That a <code>public</code> <code>virtual</code> function inherently has two significantly different jobs is a sign that it’s not separating concerns well and that we should consider a different approach.</p>
<p>What if we want to separate the specification of interface from the specification of the implementation’s customizable behavior? Then we end up with something that should remind us strongly of the Template Method pattern[2], because that’s exactly what it is: [Later note: Actually it’s a more restricted idiom with a form similar to that of Template Method. This idiom deserves its own name, and since writing this article I’ve switched to calling the idiom the Non-Virtual Interface Idiom, or NVI for short. -hps]</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 2: A more modern base class, using</span></span><br><span class="line"><span class="comment">// Template Method to separate interface from</span></span><br><span class="line"><span class="comment">// internals.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// Stable, nonvirtual interface.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Process</span><span class="params">( Gadget&amp; )</span></span>; <span class="comment">// uses DoProcess...()</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">IsDone</span><span class="params">()</span></span>;          <span class="comment">// uses DoIsDone()</span></span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">// Customization is an implementation detail that may</span></span><br><span class="line">	<span class="comment">// or may not directly correspond to the interface.</span></span><br><span class="line">	<span class="comment">// Each of these functions might optionally be</span></span><br><span class="line">	<span class="comment">// pure virtual, and if so might or might not have</span></span><br><span class="line">	<span class="comment">// an implementation in Widget; see Item 27 in [1].</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">DoProcessPhase1</span><span class="params">( Gadget&amp; )</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">DoProcessPhase2</span><span class="params">( Gadget&amp; )</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">DoIsDone</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Prefer to use Template Method to make the interface stable and nonvirtual, while delegating customizable work to nonpublic <code>virtual</code> functions that are responsible for implementing the customizable behavior. After all, <code>virtual</code> functions are designed to let derived classes customize behavior; it’s better to not let publicly derived classes also customize the inherited interface, which is supposed to be consistent.</p>
<p>The Template Method approach has several benefits and no significant drawbacks.</p>
<p>First, note that the base class is now in complete control of its interface and policy, and can enforce interface preconditions and postconditions, insert instrumentation, and do any similar work all in a single convenient reusable place - the nonvirtual interface function. This promotes good class design because it lets the base class enforce the substitutability compliance of derived classes in accord with the Liskov Substitution Principle[3], to whatever extent enforcement makes sense. If efficiency is an issue, the base class can elect to check certain kinds of pre- and postconditions only in a debug mode, for example via a non-debug “release” build that completely removes the checking code from the executable image, or via a configurable debug mode that suppresses selected checking code at runtime.</p>
<p>Second, when we’ve better separated interface and implementation, we’re free to make each take the form it naturally wants to take instead of trying to find a compromise that forces them to look the same. For example, notice that in Example 2 we’ve incidentally decided that it makes more sense for our users to see a single <code>Process()</code> function while allowing more flexible customization in two parts, <code>DoProcessPhase1()</code> and <code>DoProcessPhase2()</code>. And it was easy. We couldn’t have done this with the <code>public</code> <code>virtual</code> version without making the separation also visible in the interface, thereby adding complexity for the user who would then have to know to call two functions in the right way. (For more discussion of a related example, see also Item 23 in Exceptional C++[4].)</p>
<p>Third, the base class is now less fragile in the face of change. We are free to change our minds later and add pre- and postcondition checking, or separate processing into more steps, or refactor, or implement a fuller interface/implementation separation using the Pimpl idiom[4], or make other modifications to <code>Widget</code>‘s customizability, without affecting the code that uses <code>Widget</code>. For example, it’s much more difficult to start with a <code>public</code> <code>virtual</code> function and later try to wrap it for pre- and postcondition checking after the fact, than it is to provide a dumb passthrough nonvirtual wrapper up front (even if no checking or other extra work is immediately needed) and insert the checking later. (For more discussion of how a class like <code>Widget</code> is less fragile and more amenable to future revision and refactoring, see the article “Virtually Yours”[5].)</p>
<p>“But but but,” some have objected, “let’s say that all the <code>public</code> nonvirtual function does initially is pass through to the <code>private</code> <code>virtual</code> one. It’s just one stupid little line. Isn’t that pretty useless, and indeed haven’t we lost something? Haven’t we lost some efficiency (the extra function call) and added some complexity (the extra function)?” No, and no. First, a word about efficiency: No, none is lost in practice because if the <code>public</code> function is a one-line passthrough declared <code>inline</code>, all compilers I know of will optimize it away entirely, leaving no overhead. (Indeed, some compilers will always make such a function <code>inline</code> and eliminate it, whether you personally really wanted it to or not, but that’s another story.) Second, a word about complexity: The only complexity is the extra time it takes to write the one-line wrapper function, which is trivial. Period. That’s it. C’est tout. The interfaces are unaffected: The class still has exactly the same number of <code>public</code> functions for a <code>public</code> user to learn, and it has exactly the same number of <code>virtual</code> functions for a derived class programmer to learn. Neither the interface presented to the outside world, nor the inheritance interface presented to derived classes, has become any more complex in itself for either audience. The two interfaces are just explicitly separated, is all, and that is a Good Thing.</p>
<p>Well, that justifies nonvirtual interfaces and tells us that <code>virtual</code> functions benefit from being nonpublic, but we haven’t really answered whether <code>virtual</code> functions should be <code>private</code> or protected. So let’s answer that:</p>
<h2 id="Guideline-2-Prefer-to-make-virtual-functions-private"><a href="#Guideline-2-Prefer-to-make-virtual-functions-private" class="headerlink" title="Guideline #2: Prefer to make virtual functions private."></a>Guideline #2: Prefer to make <code>virtual</code> functions <code>private</code>.</h2><p>That’s easy. This lets the derived classes override the function to customize the behavior as needed, without further exposing the <code>virtual</code> functions directly by making them callable by derived classes (as would be possible if the functions were just protected). The point is that <code>virtual</code> functions exist to allow customization; unless they also need to be invoked directly from within derived classes’ code, there’s no need to ever make them anything but <code>private</code>. But sometimes we do need to invoke the base versions of <code>virtual</code> functions (see the article “Virtually Yours”[5] for an example), and in that case only it makes sense to make those <code>virtual</code> functions protected, thus:</p>
<h2 id="Guideline-3-Only-if-derived-classes-need-to-invoke-the-base-implementation-of-a-virtual-function-make-the-virtual-function-protected"><a href="#Guideline-3-Only-if-derived-classes-need-to-invoke-the-base-implementation-of-a-virtual-function-make-the-virtual-function-protected" class="headerlink" title="Guideline #3: Only if derived classes need to invoke the base implementation of a virtual function, make the virtual function protected."></a>Guideline #3: Only if derived classes need to invoke the base implementation of a <code>virtual</code> function, make the <code>virtual</code> function protected.</h2><p>The bottom line is that Template Method as applied to virtual functions nicely helps us to separate interface from implementation. It’s possible to make the separation even more complete, of course, by completely divorcing interface from implementation using patterns like Bridge[2], idioms like Pimpl (principally for managing compile-time dependencies and exception safety guarantees)[1] [4] or the more general handle/body or envelope/letter[6], or other approaches. Unless you need a more complete interface/implementation separation, though, Template Method will often be sufficient for your needs. On the flip side, I am arguing that this use of Template Method is also a good idea to adopt by default and view as a necessary minimum separation in practice in new code. After all, it costs nothing (beyond writing an extra line of code) and buys quite a bit of pain reduction down the road.</p>
<p>Former communist countries are learning the benefits of privatization, in those cases where privatization makes sense. The lesson of healthy privatization is likewise not lost on good class designers. For more examples of using the Template Method pattern to <code>privatize</code> <code>virtual</code> behavior, see “Virtually Yours”.[5]</p>
<p>Speaking of that article, did you notice that the code there presented a <code>public</code> <code>virtual</code> destructor? This brings us to the second topic of this month’s column:</p>
<h1 id="Virtual-Question-2-What-About-Base-Class-Destructors"><a href="#Virtual-Question-2-What-About-Base-Class-Destructors" class="headerlink" title="Virtual Question #2: What About Base Class Destructors?"></a>Virtual Question #2: What About Base Class Destructors?</h1><p>The second classic question we’ll consider is that old destructor chestnut: “Should base class destructors be <code>virtual</code>?”</p>
<p>Sigh. I wish this were only a frequently asked question. Alas, it’s more often a frequently debated question. If I had a penny for every time I’ve seen this debate, I could buy a cup of coffee. Not just any old coffee, mind you - I could buy a genuine Starbucks Venti double-Valencia latte (my current favorite). Maybe even two of them, if I was willing to throw in a dime of my own.</p>
<p>The usual answer to this question is: “Huh? Of course base class destructors should always be <code>virtual</code>!” This answer is wrong, and the C++ standard library itself contains counter examples refuting it, but it’s right often enough to give the illusion of correctness.</p>
<p>The slightly less usual and somewhat more correct answer is: “Huh? Of course base class destructors should be <code>virtual</code> if you’re going to delete polymorphically (i.e., delete via a pointer to base)!” This answer is technically right but doesn’t go far enough.</p>
<p>I’ve recently come to conclude that the fully correct answer is this:</p>
<h2 id="Guideline-4-A-base-class-destructor-should-be-either-public-and-virtual-or-protected-and-nonvirtual"><a href="#Guideline-4-A-base-class-destructor-should-be-either-public-and-virtual-or-protected-and-nonvirtual" class="headerlink" title="Guideline #4: A base class destructor should be either public and virtual, or protected and nonvirtual."></a>Guideline #4: A base class destructor should be either <code>public</code> and <code>virtual</code>, or protected and nonvirtual.</h2><p>Let’s see why this is so.</p>
<p>First, an obvious statement: Clearly any operation that will be performed through the base class interface, and that should behave virtually, should be <code>virtual</code>. That’s true even with Template Method, above, because although the <code>public</code> interface function is nonvirtual, the work is delegated to a nonpublic <code>virtual</code> function and we get the <code>virtual</code> behavior that we need.</p>
<p>If deletion, therefore, can be performed polymorphically through the base class interface, then it must behave virtually and must be <code>virtual</code>. Indeed, the language requires it - if you delete polymorphically without a <code>virtual</code> destructor, you summon the dreaded specter of “undefined behavior,” a specter I personally would rather not meet in even a moderately well-lit alley, thank you very much. Hence:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 3: Obvious need for virtual destructor.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span> <span class="comment">/*...*/</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123; <span class="comment">/*...*/</span> &#125;;</span><br><span class="line"></span><br><span class="line">Base* b = <span class="keyword">new</span> Derived;</span><br><span class="line"><span class="keyword">delete</span> b; <span class="comment">// Base::~Base() had better be virtual!</span></span><br></pre></td></tr></table></figure>

<p>Note that the destructor is the one case where the Template Method pattern cannot be applied to a <code>virtual</code> function. Why not? Because once execution reaches the body of a base class destructor, any derived object parts have already been destroyed and no longer exist. If the Base destructor body were to call a <code>virtual</code> function, the <code>virtual</code> dispatch would reach no further down the inheritance hierarchy than Base itself. In a destructor (or constructor) body, further-derived classes just don’t exist any more (or yet).</p>
<p>But base classes need not always allow polymorphic deletion. For example, in the standard library itself,[7] consider class templates such as <code>std::unary_function and std::binary_function</code>. Those two class templates look like this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Arg</span>, <span class="keyword">class</span> <span class="title">Result</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">unary_function</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">typedef</span> Arg    argument_type;</span><br><span class="line">	<span class="keyword">typedef</span> Result result_type;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Arg1</span>, <span class="keyword">class</span> <span class="title">Arg2</span>, <span class="keyword">class</span> <span class="title">Result</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">binary_function</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">typedef</span> Arg1   first_argument_type;</span><br><span class="line">	<span class="keyword">typedef</span> Arg2   second_argument_type;</span><br><span class="line">	<span class="keyword">typedef</span> Result result_type;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Both of these templates are specifically intended to be instantiated as base classes (in order to inject those standardized <code>typedef</code> names into derived classes) and yet do not provide <code>virtual</code> destructors because they are not intended to be used for polymorphic deletion. That is, code like the following is not merely unsanctioned but downright illegal, and it’s reasonable for you to assume that such code will never exist:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 4: Illegal code that you can assume</span></span><br><span class="line"><span class="comment">// will never exist.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">( std::unary_function* f )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">delete</span> f; <span class="comment">// error, illegal</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note that the standard tut-tuts and declares Example 4 to fall squarely into the Undefined Behavior Pit, but the standard doesn’t actually require a compiler to prevent you or anyone else from writing that code (more’s the pity). It would be easy and nice - and it wouldn’t break any standards-conforming C++ programs that exist today - to give <code>std::unary_function</code> (and other classes like it) an empty but protected destructor, in which case a compiler would actually be required to diagnose the error and toss it back in the offender’s face. Maybe we’ll see such a change in a future revision to the standard, maybe we won’t, but it would be nice to make compilers reject such code instead of just making tut-tut noises in standardish legalese.</p>
<p>Finally, what if a base class is concrete (can be instantiated on its own) but also wants to support polymorphic destruction? Doesn’t it need a <code>public</code> destructor then, since otherwise you can’t easily create objects of that type? That’s possible, but only if you’ve already violated another guideline, to wit: <em>Don’t derive from concrete classes</em>. Or, as Scott Meyers puts it in Item 33 of More Effective C++,[8] “Make non-leaf classes abstract.” (Admittedly, it can happen in practice - in code written by someone else, of course, not by you! - and in this one case you may have to have a <code>public</code> <code>virtual</code> destructor just to accommodate what’s already a poor design. Better to refactor and fix the design, though, if you can.)</p>
<p>In brief, then, you’re left with one of two situations. Either: a) you want to allow polymorphic deletion through a base pointer, in which case the destructor must be virtual and public; or b) you don’t, in which case the destructor should be nonvirtual and protected, the latter to prevent the unwanted usage.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In summary, prefer to make base class <code>virtual</code> functions <code>private</code> (or protected if you really must). This separates the concerns of interface and implementation, which stabilizes interfaces and makes implementation decisions easier to change and refactor later. For normal base class functions:</p>
<ul>
<li>Guideline #1: Prefer to make interfaces nonvirtual, using Template Method.</li>
<li>Guideline #2: Prefer to make <code>virtual</code> functions private.</li>
<li>Guideline #3: Only if derived classes need to invoke the base implementation of a <code>virtual</code> function, make the <code>virtual</code> function protected.</li>
</ul>
<p>For the special case of the destructor only:</p>
<ul>
<li>Guideline #4: A base class destructor should be either <code>public</code> and <code>virtual</code>, or protected and nonvirtual.</li>
</ul>
<p>True, the standard library itself does not always follow these design criteria. In part, that’s a reflection of how we as a community have learned over the years.</p>
<h1 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h1><p>[1] H. Sutter. <em>More Exceptional C++ (Addison-Wesley, 2002)</em>.</p>
<p>[2] Gamma, Helm, Johnson, and Vlissides. <em>Design Patterns: Elements of Reusable Object-Oriented Software (Addison-Wesley, 1995)</em>.</p>
<p>[3] B. Liskov. <em>“Data Abstraction and Hierarchy” (SIGPLAN Notices, 23(5), May 1988)</em>.</p>
<p>[4] H. Sutter. <em>Exceptional C++ (Addison-Wesley, 2000)</em>.</p>
<p>[5] J. Hyslop and H. Sutter. <em>“Virtually Yours” (C/C++ Users Journal Experts Forum, 18(12), December 2000)</em>.</p>
<p>[6] J. Coplien. <em>Advanced C++ Programming Styles and Idioms (Addison-Wesley, 1992)</em>.</p>
<p>[7] ISO/IEC 14882:1998(E), Programming Languages - C++ (ISO and ANSI C++ standard).</p>
<p>[8] S. Meyers. <em>More Effective C++ (Addison-Wesley, 1996)</em>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/Virtuality/" data-id="cknzlw0ln000lgsos5fwr7kti" data-title="Virtuality" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-When-to-use-virtual-destructors" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/When-to-use-virtual-destructors/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T13:41:17.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/When-to-use-virtual-destructors/">When to use virtual destructors?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors">https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors</a></p>
</blockquote>
<blockquote>
<p>I have a solid understanding of most OOP theory but the one thing that confuses me a lot is virtual destructors.<br>I thought that the destructor always gets called no matter what and for every object in the chain.<br>When are you meant to make them virtual and why?</p>
</blockquote>
<p>Virtual destructors are useful when you might potentially delete an instance of a derived class through a pointer to base class:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// some virtual methods</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line">    ~<span class="built_in">Derived</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Do some important cleanup</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Here, you’ll notice that I didn’t declare Base’s destructor to be <code>virtual</code>. Now, let’s have a look at the following snippet:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Base *b = <span class="keyword">new</span> <span class="built_in">Derived</span>();</span><br><span class="line"><span class="keyword">delete</span> b; <span class="comment">// Here&#x27;s the problem!</span></span><br></pre></td></tr></table></figure>

<p>Since Base’s destructor is not <code>virtual</code> and <code>b</code> is a <code>Base*</code> pointing to a Derived object, <code>delete b</code> has undefined behaviour:</p>
<blockquote>
<p>[In <code>delete b</code>], if the static type of the object to be deleted is different from its dynamic type, the static type shall be a base class of the dynamic type of the object to be deleted and <strong>the static type shall have a virtual destructor or the behavior is undefined</strong>.</p>
</blockquote>
<p>In most implementations, the call to the destructor will be resolved like any non-virtual code, meaning that the destructor of the base class will be called but not the one of the derived class, resulting in a resources leak.</p>
<p>To sum up, always make base classes’ destructors <code>virtual</code> when they’re meant to be manipulated polymorphically.</p>
<p>If you want to prevent the deletion of an instance through a base class pointer, you can make the base class destructor protected and nonvirtual; by doing so, the compiler won’t let you call <code>delete</code> on a base class pointer.</p>
<p>You can learn more about virtuality and <code>virtual</code> base class destructor in <a target="_blank" rel="noopener" href="http://www.gotw.ca/publications/mill18.htm">this article from Herb Sutter</a>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/When-to-use-virtual-destructors/" data-id="cknzlw0ld000dgsosbzyk9e83" data-title="When to use virtual destructors?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-What-is-the-use-of-having-destructor-as-private" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/What-is-the-use-of-having-destructor-as-private/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T13:12:57.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/What-is-the-use-of-having-destructor-as-private/">What is the use of having destructor as private?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/631783/what-is-the-use-of-having-destructor-as-private">https://stackoverflow.com/questions/631783/what-is-the-use-of-having-destructor-as-private</a></p>
</blockquote>
<p>Basically, any time you want some other class to be responsible for the life cycle of your class’ objects, or you have reason to prevent the destruction of an object, you can make the destructor <code>private</code>.</p>
<p>For instance, if you’re doing some sort of reference counting thing, you can have the object (or manager that has been <code>friend</code>ed) responsible for counting the number of references to itself and delete it when the number hits zero. A <code>private</code> dtor would prevent anybody else from deleting it when there were still references to it.</p>
<p>For another instance, what if you have an object that has a manager (or itself) that may destroy it or may decline to destroy it depending on other conditions in the program, such as a database connection being open or a file being written. You could have a <code>request_delete</code> method in the class or the manager that will check that condition and it will either delete or decline, and return a status telling you what it did. That’s far more flexible that just calling “delete”.</p>
<p>Such an object <strong>can only be created on the stack in the scope of a <code>friend</code> or itself</strong>. Additionally it cannot ba a static or global object. And deletion has to be done via a <code>friend</code> or a member. A product may use a single Object hierarchy and a custom memory-manager – such scenarios may use a <code>private</code> dtor. <strong>Such an object can be created on the stack by using placement <code>new</code>.</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span> &#123;</span></span><br><span class="line">    ~<span class="built_in">a</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">delete_a</span><span class="params">(a* p)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_a</span><span class="params">(a* p)</span>  </span>&#123;</span><br><span class="line">    <span class="keyword">delete</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a *p = <span class="keyword">new</span> a;</span><br><span class="line">    <span class="built_in">delete_a</span>(p);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Example from The C++ Programming Language 17.2.4 Calling Constructors and Destructors.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nonlocal</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123; <span class="keyword">this</span>−&gt; ̃<span class="built_in">Nonlocal</span>(); &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">     ̃<span class="built_in">Nonlocal</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Nonlocal x;            <span class="comment">// error: cannot destory a Nonlocal</span></span><br><span class="line">    X* p = <span class="keyword">new</span> Nonlocal;   <span class="comment">// OK</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">delete</span> p;              <span class="comment">// error: cannot destroy a Nonlocal</span></span><br><span class="line">	p.<span class="built_in">destroy</span>();           <span class="comment">// OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/What-is-the-use-of-having-destructor-as-private/" data-id="cknzlw0l70005gsos8vt18tcx" data-title="What is the use of having destructor as private?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-What-uses-are-there-for-placement-new" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/What-uses-are-there-for-placement-new/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T12:59:00.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/What-uses-are-there-for-placement-new/">What uses are there for &#34;placement new&#34;?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/222557/what-uses-are-there-for-placement-new">https://stackoverflow.com/questions/222557/what-uses-are-there-for-placement-new</a></p>
</blockquote>
<blockquote>
<p>Has anyone here ever used C++’s “placement new”? If so, what for? It looks to me like it would only be useful on memory-mapped hardware.</p>
</blockquote>
<p>Placement new allows you to <strong>construct an object in memory that’s already allocated</strong>.</p>
<p>You may want to do this for optimization when you need to construct multiple instances of an object, and it is faster not to re-allocate memory each time you need a new instance. Instead, it might be more efficient to perform a single allocation for a chunk of memory that can hold multiple objects, even though you don’t want to use all of it at once.</p>
<p>DevX gives a <a target="_blank" rel="noopener" href="http://www.devx.com/tips/Tip/12582">good example</a>:</p>
<blockquote>
<p>Standard C++ also supports placement new operator, which constructs an object on a pre-allocated buffer. This is useful when building a memory pool, a garbage collector or simply when performance and exception safety are paramount (there’s no danger of allocation failure since the memory has already been allocated, and constructing an object on a pre-allocated buffer takes less time):</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *buf  = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in"><span class="keyword">sizeof</span></span>(string)]; <span class="comment">// pre-allocated buffer</span></span><br><span class="line">string *p = <span class="built_in"><span class="keyword">new</span></span> (buf) <span class="built_in">string</span>(<span class="string">&quot;hi&quot;</span>);    <span class="comment">// placement new</span></span><br><span class="line">string *q = <span class="keyword">new</span> <span class="built_in">string</span>(<span class="string">&quot;hi&quot;</span>);          <span class="comment">// ordinary heap allocation</span></span><br></pre></td></tr></table></figure>

<p>You may also want to be sure there can be <em>no allocation failure at a certain part of critical code</em> (for instance, in code executed by a pacemaker). In that case you would want to allocate memory earlier, then use placement new within the critical section.</p>
<p>Deallocation in placement new<br>You should not deallocate every object that is using the memory buffer. Instead you should <code>delete[]</code> only the original buffer. You would have to then call the destructors of your classes manually. For a good suggestion on this, please see Stroustrup’s FAQ on: <a target="_blank" rel="noopener" href="https://www.stroustrup.com/bs_faq2.html#placement-delete">Is there a “placement delete”?</a>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/What-uses-are-there-for-placement-new/" data-id="cknzlw0lb000agsos2na58pm1" data-title="What uses are there for &#34;placement new&#34;?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Constructors-and-destructors-order-with-class-hierarchies" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/Constructors-and-destructors-order-with-class-hierarchies/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T12:49:40.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/Constructors-and-destructors-order-with-class-hierarchies/">Constructors and destructors order with class hierarchies</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>The C++ Programming Language 17.2.3 Base and Member Destructors</p>
</blockquote>
<p>Constructors and destructors interact correctly with class hierarchies. A constructor builds a class object <strong>from the bottom up</strong>:</p>
<p>[1] first, the constructor invokes its base class constructors,<br>[2] then, it invokes the member constructors, and<br>[3] finally, it executes its own body.</p>
<p>A destructor <strong>tears down</strong> an object in the reverse order:</p>
<p>[1] first, the destructor executes its own body,<br>[2] then, it invokes its member destructors, and<br>[3] finally, it invokes its base class destructors.</p>
<p>In particular, a <code>virtual</code> base is constructed before any base that might use it and destroyed after all such bases. This ordering ensures that a base or a member is not used before it has been initialized or used after it has been destroyed. The programmer can defeat this simple and essential rule, but only through deliberate circumvention involving passing pointers to uninitialized variables as arguments. Doing so violates language rules and the results are usually disastrous.</p>
<p>Constructors execute member and base constructors in <strong>declaration order</strong> (not the order of initializers): if two constructors used a different order, the destructor could not (without serious overhead) guarantee to destroy in the reverse order of construction.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">X</span> &#123;</span> <span class="built_in">X</span>(<span class="keyword">int</span>); &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">S2</span> &#123;</span></span><br><span class="line">    X x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">S2 x1;     <span class="comment">// error</span></span><br><span class="line">S2 x2 &#123;<span class="number">1</span>&#125;; <span class="comment">// OK: x2.x is initialized with 1</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/Constructors-and-destructors-order-with-class-hierarchies/" data-id="cknzlw0kv0000gsos1wny1wbc" data-title="Constructors and destructors order with class hierarchies" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-What-is-an-invariant" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/What-is-an-invariant/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T12:34:09.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/What-is-an-invariant/">What is an invariant?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/112064/what-is-an-invariant">https://stackoverflow.com/questions/112064/what-is-an-invariant</a></p>
</blockquote>
<blockquote>
<p>The word seems to get used in a number of contexts. The best I can figure is that they mean a variable that can’t change. Isn’t that what constants/finals (darn you Java!) are for?</p>
</blockquote>
<p>An <strong>invariant</strong> is more “conceptual” than a variable. In general, it’s a property of the program state that is always true. A function or method that ensures that the invariant holds is said to maintain the invariant.</p>
<p>For instance, a binary search tree might have the invariant that for every node, the key of the node’s left child is less than the node’s own key. A correctly written insertion function for this tree will maintain that invariant.</p>
<p>As you can tell, that’s not the sort of thing you can store in a variable: it’s more a statement about the program. By figuring out what sort of invariants your program should maintain, then reviewing your code to make sure that it actually maintains those invariants, you can avoid logical errors in your code.</p>
<p>Reference: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Invariant_(mathematics)#Invariants_in_computer_science">Wikipedia Invariants in computer science</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/What-is-an-invariant/" data-id="cknzlw0l40003gsos212d1p6s" data-title="What is an invariant?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-What-is-the-difference-between-a-concrete-class-and-an-abstract-class" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/19/What-is-the-difference-between-a-concrete-class-and-an-abstract-class/" class="article-date">
  <time class="dt-published" datetime="2021-04-19T11:28:51.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/What-is-the-difference-between-a-concrete-class-and-an-abstract-class/">What is the difference between a concrete class and an abstract class?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2149207/what-is-the-difference-between-a-concrete-class-and-an-abstract-class">https://stackoverflow.com/questions/2149207/what-is-the-difference-between-a-concrete-class-and-an-abstract-class</a></p>
</blockquote>
<blockquote>
<p>I am learning C++, but I am confused about abstract class and concrete class. Some real world examples would be appreciated.<br>what is the difference between normal derived class and concrete class?</p>
</blockquote>
<p>An <strong>abstract class</strong> is a class for which one or more methods are declared but not defined, meaning that the compiler knows <em>these methods are part of the class, but not what code to execute for that method</em>. These are called abstract methods. Here is an example of an abstract class.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">shape</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>This declares an abstract class which specifies that any descendants of the class should implement the <code>draw</code> method if the class is to be <strong>concrete</strong>. You cannot instantiate this class because it is abstract, after all, the compiler wouldn’t know what code to execute if you called member <code>draw</code>. So you can not do the following:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">shape <span class="title">my_shape</span><span class="params">()</span></span>;</span><br><span class="line">my_shape.<span class="built_in">draw</span>();</span><br></pre></td></tr></table></figure>

<p>To be able to actually use the draw method you would need to <em>derive</em> classes from this abstract class, which do implement the <code>draw</code> method, making the classes concrete:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">circle</span> :</span> <span class="keyword">public</span> shape &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">circle</span>(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> radius) &#123;</span><br><span class="line">    <span class="comment">/* set up the circle */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do stuff to draw the circle */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">rectangle</span> :</span> <span class="keyword">public</span> shape &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">rectangle</span>(<span class="keyword">int</span> min_x, <span class="keyword">int</span> min_y, <span class="keyword">int</span> max_x, <span class="keyword">int</span> max_y) &#123;</span><br><span class="line">    <span class="comment">/* set up rectangle */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do stuff to draw the rectangle */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Now you can instantiate the concrete objects <code>circle</code> and <code>rectangle</code> and use their <code>draw</code> methods:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">circle <span class="title">my_circle</span><span class="params">(<span class="number">40</span>, <span class="number">30</span>, <span class="number">10</span>)</span></span>;</span><br><span class="line"><span class="function">rectangle <span class="title">my_rectangle</span><span class="params">(<span class="number">20</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">15</span>)</span></span>;</span><br><span class="line">my_circle.<span class="built_in">draw</span>();</span><br><span class="line">my_rectangle.<span class="built_in">draw</span>();</span><br></pre></td></tr></table></figure>

<p>Now of course the question is, why would you want to do this? Couldn’t you just as well have defined the <code>circle</code> and <code>rectangle</code> classes and have done away with the whole shape class? You could, but then you wouldn’t be able to take advantage of their inheritance:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;shape*&gt; my_scene;</span><br><span class="line">my_scene.push_back(new circle(40, 30, 10));</span><br><span class="line">my_scene.push_back(new rectangle(20, 10, 50, 15));</span><br><span class="line">std::for_each(my_scene.begin(), my_scene.end(), std::mem_fun_ref(&amp;shape::draw)</span><br></pre></td></tr></table></figure>

<p>This code let’s you collect all your shapes into one container. This makes it a lot easier if you have a lot of shapes and many different shapes in your scene. For example we can now draw all the shapes in one go, and the code that does so doesn’t even need to know about the different types of shapes we have.</p>
<p>Now finally we need to know why the <code>draw</code> function of <code>shape</code> is abstract, and not just an empty function, i.e. why didn’t we just define:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">shape</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do nothing */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>The reason for this is that we don’t really want objects of type <code>shape</code>, they wouldn’t be real things anyway, they would be abstract. So it doesn’t make any sense to define an implementation for the <code>draw</code> method, even an empty one. Making the <code>shape</code> class abstract prevents us from mistakenly instantiating the <code>shape</code> class, or mistakenly calling the empty <code>draw</code> function of the base class instead of the <code>draw</code> function of the derived classes. In effect we define an interface for any class that would like to behave like a shape, we say that any such class should have a <code>draw</code> method that looks like we have specified it should.</p>
<p>To answer you last question, there isn’t any such thing as a ‘normal derived class’ <em>every class is either abstract or concrete</em>. A class that has any abstract methods is abstract, any class that doesn’t is concrete. It’s just a way to differentiate the two types of classes. A base class can be either abstract or concrete and a derived class can be either abstract or concrete:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">abstract_base</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method2</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">concrete_base</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">concrete_method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do something */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">abstract_derived1</span> :</span> <span class="keyword">public</span> abstract_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method3</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">abstract_derived2</span> :</span> <span class="keyword">public</span> concrete_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method3</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">abstract_derived3</span> :</span> <span class="keyword">public</span> abstract_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="title">abstract_method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do something */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* note that we do not provide an implementation for</span></span><br><span class="line"><span class="comment">     abstract_method2 so the class is still abstract */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">concrete_derived1</span> :</span> <span class="keyword">public</span> concrete_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">concrete_method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do something */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">concrete_derived2</span> :</span> <span class="keyword">public</span> abstract_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do something */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">abstract_method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* do something */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* This class is now concrete because no abstract methods remain */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/19/What-is-the-difference-between-a-concrete-class-and-an-abstract-class/" data-id="cknzlw0l50004gsose3no7c6y" data-title="What is the difference between a concrete class and an abstract class?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-What-s-this-extern-C-thing" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/12/What-s-this-extern-C-thing/" class="article-date">
  <time class="dt-published" datetime="2021-04-12T13:14:16.000Z" itemprop="datePublished">2021-04-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/12/What-s-this-extern-C-thing/">What&#39;s this extern &#34;C&#34; thing?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://web.archive.org/web/20181115023158/http://www.comeaucomputing.com/techtalk/#externc">What’s this extern “C” thing?</a></p>
</blockquote>
<p>Most C++ compilers do something called <em>name decoration</em>, or <em>name mangling</em>. In short, in order to support C++ function overloading, and C++ type-safe linkage, most C++ compilers will tack on some type encoding information onto the end of some of your identifiers. For instance, when Comeau C++ see this prototype</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">double</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>it internally changes the name to <code>foo__Fid</code>, where the <code>F</code> indicates that it is a function, the <code>i</code> indicates the first argument is an <code>int</code> and the <code>d</code> indicates that the second argument is a <code>double</code>. Other compilers do this in a similar manner. Since the definition of this function will be similarly decorated, the linker will resolve this symbol fine.</p>
<p>Now, consider something such as <code>printf</code> which is normally prototyped as follows:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">printf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *, ...)</span></span>;</span><br></pre></td></tr></table></figure>

<p>which hence might map into <code>printf__FPCce</code>. However, if <code>printf</code> was compiled with a C compiler, well, no C compiler that we know of does name decorating (although they could, they don’t), therefore, the name will not be resolved by the linker. To get around this, in most cases, you should use a linkage specification. Here’s the above example again:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">double</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>Now most implementations will not decorate <code>foo</code> any longer. Of course, you would <code>extern &quot;C&quot;</code> the function definition too (since the definition file should also be <code>#include</code>ing the header file which contains the prototype, that will be satisfactory as far as the compiler is concerned, though you should consider self-documenting code). As well, if you have many such functions, you can create linkage blocks, consider:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stdio.h</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">printf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *, ...)</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, most C++ compilers will not decorate <code>printf</code>‘s name, therefore, it will probably now link with the binary version that was compiled by the C compiler. It’s often useful to create a “co-ed” header file, so in such cases, this coding technique might be helpful:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stdio.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// stuff from before</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>Since Standard C is not required to define <code>__cplusplus</code>, then, when compiling with a C compiler, the extern block won’t be established (but of course all the prototypes and such will be, which is as the C compiler would expect it).</p>
<p>Please note that name decoration is not required by C++, it is strictly an implementation detail. However, all C++ compilers do it. Similarly, a linkage specification should be considered a fighting chance at cross language linkage and not a guarantee. Again though, for most platforms, the reality is that it will work fine.</p>
<p>Too, do note that a linkage specification does not bring you into the other language! That is, you are still writing C++ code. As such, note that C++ keywords are still in existance even within a linkage specification – so for instance, using <code>new</code> or <code>bool</code> or <code>private</code> as identifier names will end up being kicked out as errors; obviously then you’ll need to rename those identifiers (you could do some preprocessor gymanstics but in the long run doing so usually does not pan out). Also note that doing something like passing a class based object, a reference, etc., to a C function means you are on your own. Note that other things effect name decoration too, such as a <code>class</code> name, <code>namespace</code>, etc. As well, you won’t be overloading a function which you’ve <code>extern &quot;C&quot;</code>d because then you would have two functions with the same name (since most implementation wouldn’t mangle them).</p>
<p>Also, doing this is usually a mistake:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123; <span class="comment">// wrapped around #include, but prefer within header</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SomeHeaderFile.h&quot;</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>because if the header is not prepared for being <code>extern &quot;C&quot;</code>d then doing the above is most likely just going to result in a bunch of error messages, and probably cryptically so too. Chances are good that the header will drag in other headers and bad fun will just ensue from there with nested headers, typedefs and who knows what else. Your <code>extern &quot;C&quot;</code>ing should follow the Las Vegas tenet <em>What happens in extern “C” stays in extern “C”</em> and <strong>keep your <code>extern &quot;C&quot;</code> blocks within files not across them</strong>.</p>
<p>The above has so far considered only the scenario of calling a C function from C++. The contrary, calling a C++ function from a C function, has the same solution. In other words, if you <code>extern &quot;C&quot;</code> a C++ function, then most implementations won’t mangle it, therefore, most C compilers will be able to link with it. However, as just mentioned, if the C++ function expects something such as a reference argument, you are usually of course on your own. There’s other issues too in this direction, for instance, consideration of C++’s overloading, the function expecting a C++ class based object as a parameter, etc. If it’s not clear, C does not have all the features available in C++, and trying to mimic them (the calling routine(s) from C will have to do this) can be challenging to say the least in some cases. This all tends to complete with calling a C++ function from C, even with <code>extern &quot;C&quot;</code>. In some cases, it may be worth considering stubs routines to try and ease the pain, but this should be decided carefully. Of course as well, a C++ application can use C++ functions which have been <code>extern &quot;C&quot;</code>d.</p>
<p>There are other aspect to linkage specifications that you might want to be aware of. For instance, it can be applied to objects. With the above under your belt, you may now want to pursue a quality C++ text book on this matter.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/12/What-s-this-extern-C-thing/" data-id="cknzlw0la0008gsosaj06ay3y" data-title="What&#39;s this extern &#34;C&#34; thing?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Why-is-an-unnamed-namespace-used-instead-of-static" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/12/Why-is-an-unnamed-namespace-used-instead-of-static/" class="article-date">
  <time class="dt-published" datetime="2021-04-12T10:43:45.000Z" itemprop="datePublished">2021-04-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/12/Why-is-an-unnamed-namespace-used-instead-of-static/">Why is an unnamed namespace used instead of static?</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="https://web.archive.org/web/20181115023158/http://www.comeaucomputing.com/techtalk/#nostatic">Why is an unnamed namespace used instead of static?</a></p>
</blockquote>
<p>in C++, some uses of the <code>static</code> keyword have been <strong>deprecated</strong>. In particular, an unnamed namespace should be favored over some previous uses of “file scope static’s”. In fact in some cases an unnamed namespace must be used in order to obtain a similar effect. That is to say, this code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x.cpp</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> flag = <span class="literal">false</span>; <span class="comment">// AAA</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="keyword">if</span> (flag)... &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bar</span><span class="params">()</span> </span>&#123; ...flag = <span class="literal">true</span>... &#125;</span><br></pre></td></tr></table></figure>

<p>should instead often be composed this way in C++:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x.cpp</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="comment">/* NOTHING HERE!! */</span> &#123; <span class="comment">// BBB</span></span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>; <span class="comment">// no need for static here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The use of static in <code>AAA</code> indicates that flag has internal linkage. This means that flag is local to its translation unit (that is, effectively it is only known by its name in some source file, in this case <code>x.cpp</code>). This means that flag can’t be used by another translation unit (by its name at least). The goal is to have less global/cross-file name pollution in your programs while at the same time achieving some level of encapsulation. Such a goal is usually considered admirable and so therefore is often considered desirable (note that the goal, not the code, is being discussed in this sentence).</p>
<p>Contrast this to <code>BBB</code>. In the case of using the unnamed namespace above, flag has external linkage, yet it is effectively local to the translation unit. It is effectively still local because although we did not give the namespace a name, the compiler generated a unique name for it. In effect, the compiler changes <code>BBB</code> into this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Just get UNIQUE established</span></span><br><span class="line"><span class="keyword">namespace</span> UNIQUE &#123; &#125; <span class="comment">// CCC</span></span><br><span class="line"><span class="comment">// Bring UNIQUE into this translation unit</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> UNIQUE;</span><br><span class="line"><span class="comment">// Now define UNIQUEs members</span></span><br><span class="line"><span class="keyword">namespace</span> UNIQUE &#123;</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>; <span class="comment">// As Before</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For each translation unit, a uniquely generated identifier name for <code>UNIQUE</code> somehow gets synthesized by the compiler, with the effect that no other translation unit can see names from an unnamed namespace, hence making it local even though the name may have external linkage.</p>
<p>Therefore, although flag in <code>CCC</code> has external linkage, its real name is <code>UNIQUE::flag</code>, but since <code>UNIQUE</code> is only known to <code>x.cpp</code>, it’s effectively local to <code>x.cpp</code> and is therefore not known to any other translation unit.</p>
<p>Ok, so far, most of the discussion has been about how the two provide local names, but what are the differences? And why was static deprecated and the unnamed namespace considered superior?</p>
<p>First, if nothing else, static means many different things in C++ and reducing one such use is considered a step in the right direction by some people. Second to consider is that names in unnamed namespaces may have external linkage whereas with static a name must have internal linkage. In other words, although there is a syntactic transformation shown above between <code>AAA</code> and <code>BBB</code>, the two are not exactly equal (the one between <code>BBB</code> and <code>CCC</code> is equal).</p>
<p>Most books and usenet posts usually leave you off about right here. No problem with that per se, as the above info is not to be tossed out the window. However, you can’t help but keep wondering what the <strong>BIG</strong> deal some people make about unnamed namespaces are. Some folks might even argue that they make your code less readable.</p>
<p>What’s significant though is that <strong>some template arguments cannot be names with internal linkage</strong>, instead some require names with external linkage. Remember, the types of the arguments to templates become part of the instantiation type, but names with internal linkage aren’t available to other translation units. A good rule of thumb to consider (said rather loosely) is that external names shouldn’t depend upon names with less linkage (definitely not of those with no linkage, and often not even w ith names of internal linkage). And so it follows from the above that instantiating such a template with a static such as from AAA just isn’t going to work. This is all similar to why these won’t work:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">const</span> <span class="keyword">int</span>&amp; T&gt; <span class="class"><span class="keyword">struct</span> <span class="title">xyz</span> &#123;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> c = <span class="number">1</span>;</span><br><span class="line">xyz&lt;c&gt; y; <span class="comment">// ok</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> sc = <span class="number">1</span>; <span class="comment">// This is the kicker-out&#x27;er above</span></span><br><span class="line">xyz&lt;sc&gt; y2; <span class="comment">// not ok</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">char</span> *p&gt; <span class="class"><span class="keyword">struct</span> <span class="title">abc</span> &#123;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> comeau[] = <span class="string">&quot;Comeau C++&quot;</span>;</span><br><span class="line">abc&lt;comeau&gt; co; <span class="comment">// ok</span></span><br><span class="line">abc&lt;<span class="string">&quot;Comeau C++&quot;</span>&gt; co2; <span class="comment">// not ok</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">struct</span> <span class="title">qaz</span> &#123;</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buf[] = <span class="string">&quot;local&quot;</span>;</span><br><span class="line">    abc&lt;buf&gt; lb; <span class="comment">// not ok</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> buf2[] = <span class="string">&quot;local&quot;</span>;</span><br><span class="line">    abc&lt;buf2&gt; lb2; <span class="comment">// not ok</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qwerty</span> &#123;</span>&#125;;</span><br><span class="line">    qaz&lt;qwerty&gt; dq; <span class="comment">// not ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Last but not least, <code>static</code> and unnamed namespaces are not the same because <code>static</code> is deficient as a name constrainer. Sure, a C programmer might use it for flag above, but what do you do when you want to layer or just encapsulate say a class, template, enum, or even another namespace? …for that you need namespaces. It might even be argued that you should wrap all your files in an unnamed namespace (all the file’s functions, classes, whatever) and then only pull out the parts other files should know about.</p>
<p>Draw your attention to that that none of the above is equal to this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x.cpp</span></span><br><span class="line"><span class="keyword">namespace</span> &#123; <span class="comment">// DDD</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(The point of showing <code>DDD</code> is that you really wouldn’t want to say it. I guess one could say that it is redundant, and really just brings all the above issues right back (as in this flavor, it’s not external). So, it’s only shown to make sure you see that none of the previous versions look like this :).</p>
<p>Note that namespaces containing <code>extern &quot;C&quot;</code> declarations are in some ways as if they were not declared in the namespace, so since an unnamed namespace is a namespace, this holds true for an unnamed namespace as well.</p>
<p>Note also that the above discussion does not apply to the other uses of static: static lifetime, static members or to static locals in a function.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://humphrycc.github.io/2021/04/12/Why-is-an-unnamed-namespace-used-instead-of-static/" data-id="cknzlw0lf000fgsos54joclul" data-title="Why is an unnamed namespace used instead of static?" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/c/" style="font-size: 10px;">c++</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/27/Do-we-need-User-defined-literal/">Do we need User-defined literal?</a>
          </li>
        
          <li>
            <a href="/2021/04/19/Virtuality/">Virtuality</a>
          </li>
        
          <li>
            <a href="/2021/04/19/When-to-use-virtual-destructors/">When to use virtual destructors?</a>
          </li>
        
          <li>
            <a href="/2021/04/19/What-is-the-use-of-having-destructor-as-private/">What is the use of having destructor as private?</a>
          </li>
        
          <li>
            <a href="/2021/04/19/What-uses-are-there-for-placement-new/">What uses are there for &#34;placement new&#34;?</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>